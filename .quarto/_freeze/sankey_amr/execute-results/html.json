{
  "hash": "660b10fdf1603ffdf49eb16cc6bf1573",
  "result": {
    "engine": "knitr",
    "markdown": "---\nbibliography: references.bib\ncsl: nature-communications.csl\nnocite: |\n   @*\n---\n\n\n\n## Sankey plot to visualise *E. coli* resistance genes\n\nHere are the steps I used to generate my Sankey diagram.\n\n### Packages\n\nIf you haven't done so already install the packages networkD3, tidyverse, htmlwidgets, manipulateWidget and webshot2.\n\nLoad the libraries\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(networkD3)\nlibrary(tidyverse)\nlibrary(htmlwidgets)\nlibrary(manipulateWidget)\nlibrary(webshot2)\n```\n:::\n\n\n\n### Read in and prepare data\n\nThe following code was adapted from <https://r-graph-gallery.com/321-introduction-to-interactive-sankey-diagram-2.html> (and a little bit of help from chatgpt when I had trouble setting up the groups). Two dataframes are needed to generate a Sankey diagram. One for the links and the other for the nodes. In the r graph gallery example the links dataframe was generated using the data.frame() function. Initially I tried this, but then it became too messy when I was adding multiple antibiotic classes so I read in a csv file.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinks <- read_csv(\"data/resistance_mechanisms.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 74 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): source, target\ndbl (1): value\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n\nMy csv file contains three columns: source, target, value. Source is the origin of each data link. Given, my Sankey diagram has three columns, source is both the name of the of the antibiotic classes and the mechanisms. Target is the endpoint of each data link. This contains the mechanisms and resistance genes.Value is the relative thickness of each link.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#First six lines of my data frame\nhead(links)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 3\n  source           target                 value\n  <chr>            <chr>                  <dbl>\n1 Aminoglycosides  Enzymatic inactivation    14\n2 Aminoglycosides  Target alteration          8\n3 Aminoglycosides  Efflux pump                2\n4 Fluoroquinolones Enzymatic inactivation     2\n5 Fluoroquinolones Target alteration          8\n6 Fluoroquinolones Target protection          2\n```\n\n\n:::\n:::\n\n\n\nThe \\` in some of my gene names is read in as ? so first I replace the ? with ′\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinks$target <- str_replace_all(links$target, \"\\\\?\", \"′\") \n```\n:::\n\n\n\nNext I created a one column data frame for all the nodes.The column name is labelled name and the observations are all the unique names from source and target.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnodes <- data.frame(\n  name = unique(c(as.character(links$source), as.character(links$target))))\n```\n:::\n\n\n\nA second column was added to the nodes dataframe called group. This will be used to colour the Sankey diagram links by group.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Grouping\nnodes$group <- case_when(\n  nodes$name == \"Aminoglycosides\" ~ \"Aminoglycosides\",\n  nodes$name == \"Fluoroquinolones\" ~ \"Fluoroquinolones\",\n  nodes$name == \"Tetracyclines\" ~ \"Tetracyclines\",\n  nodes$name == \"Phenicols\" ~ \"Phenicols\",\n  nodes$name == \"Sulfonamides & Trimethoprim\" ~ \"Sulfonamides\",\n  nodes$name == \"Nitrofurans\" ~ \"Nitrofurans\",\n  nodes$name == \"Macrolides\" ~ \"Macrolides\",\n  nodes$name %in% c(\"aac(3′)\", \"aadA\", \"aadB\", \"aadD\",\n                    \"aph(3′)\", \"aphA15\", \"rrsH*\", \"rsmG*\") ~ \"Aminoglycosides\",\n  nodes$name %in% c(\"gyrA*\", \"gyrB*\", \"parC*\", \"parE*\", \"qep\", \"qnr\", \"oqxAB\") ~ \"Fluoroquinolones\",\n  nodes$name %in% c(\"tetX\", \"tetM\", \"tetW\", \"tetA\", \"tetB\", \"tetC\", \"tetD\") ~ \"Tetracyclines\",\n  nodes$name %in% c(\"catB\", \"catII\", \"cmlA\", \"floR\") ~ \"Phenicols\",\n  nodes$name %in% c(\"dfr\", \"folP*\", \"sul1\", \"sul2\", \"sul3\", \"sul4\") ~ \"Sulfonamides\",\n  nodes$name %in% c(\"nfsA*\", \"nfsB*\", \"ahpF*\", \"ribB*\", \"ribE*\") ~ \"Nitrofurans\",\n  nodes$name %in% c(\"ermA\", \"ermB\", \"ermC\", \"ereA\", \"mphA\", \"mphB\", \"mefA\", \"mefB\", \"msrA\", \"msrD\") ~ \"Macrolides\",\n  TRUE ~ \"Other\"\n)\n```\n:::\n\n\n\nTwo additional columns were added, which contain an index for both the source and the target. The match function is used to match the position of the values that are being matched. As I understand it networkD3 uses an index system starting from 0, whereas base R starts from 1, hence the -1 is needed to generate an index system suitable for the function networkD3::sankeyNetwork().\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ID mapping\nlinks$IDsource <- match(links$source, nodes$name) - 1\nlinks$IDtarget <- match(links$target, nodes$name) - 1\n\nlinks\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 74 × 5\n   source           target                 value IDsource IDtarget\n   <chr>            <chr>                  <dbl>    <dbl>    <dbl>\n 1 Aminoglycosides  Enzymatic inactivation    14        0        7\n 2 Aminoglycosides  Target alteration          8        0        8\n 3 Aminoglycosides  Efflux pump                2        0        9\n 4 Fluoroquinolones Enzymatic inactivation     2        1        7\n 5 Fluoroquinolones Target alteration          8        1        8\n 6 Fluoroquinolones Target protection          2        1       10\n 7 Fluoroquinolones Efflux pump                6        1        9\n 8 Tetracyclines    Enzymatic inactivation     2        2        7\n 9 Tetracyclines    Target alteration          4        2        8\n10 Tetracyclines    Target protection          4        2       10\n# ℹ 64 more rows\n```\n\n\n:::\n:::\n\n\n\nSimilar to the nodes dataframe a group column was also added to the links dataframe.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Generate vector containing the group names for all the antibiotic classes\nclass <- c(\"Aminoglycosides\", \"Fluoroquinolones\", \"Tetracyclines\", \"Phenicols\", \"Sulfonamides & Trimethoprim\", \"Nitrofurans\", \"Macrolides\")\n#Generate vector containing the group names for all the mechanisms\nmechanisms <- c(\"Enzymatic inactivation\", \"Target alteration\", \"Target protection\", \"Efflux pump\", \"Target replacement\", \"Reduced prodrug activation\")\n\n# Assign groups\nlinks$group <- case_when(\n  links$source %in% class ~ nodes$group[match(links$source, nodes$name)],\n  links$source %in% mechanisms ~ nodes$group[match(links$target, nodes$name)],\n  TRUE ~ \"Other\")\n```\n:::\n\n\n\nLastly I generated my colour scale. Here (as I understand it) because networkD3 uses Javascript code the colour scale also has to be written in Javascript. '.domain' defines each group that I want to apply each colour to.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_color <- 'd3.scaleOrdinal()\n  .domain([\"Aminoglycosides\", \"Fluoroquinolones\", \"Tetracyclines\", \n           \"Phenicols\", \"Sulfonamides\", \"Nitrofurans\", \"Macrolides\", \"Other\"])\n  .range([\"#90CAF9\", \"#A5D6A7\", \"#D1C4E9\", \"#ffffb3\", \"#fb8072\", \"#fdb462\", \"#F8BBD0FF\", \"#E0E0E0\"]);'\n```\n:::\n\n\n\n### Sankey diagram\n\nNow for the fun part generating the Sankey diagram.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Sankey plot\nq <- sankeyNetwork(\n  Links = links, Nodes = nodes,\n  Source = \"IDsource\", Target = \"IDtarget\",\n  Value = \"value\", NodeID = \"name\",\n  NodeGroup = \"group\", LinkGroup = \"group\",\n  colourScale = my_color,\n  width = 900, height = 900,\n  nodeWidth = 60\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLinks is a tbl_df. Converting to a plain data frame.\n```\n\n\n:::\n\n```{.r .cell-code}\nq\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-0fc3d4874d5e9dc15e34\" style=\"width:100%;height:650px;\" class=\"sankeyNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-0fc3d4874d5e9dc15e34\">{\"x\":{\"links\":{\"source\":[0,0,0,1,1,1,1,2,2,2,2,3,3,4,4,4,5,6,6,7,7,7,7,7,7,7,8,8,8,8,9,7,8,8,8,8,10,9,9,9,7,8,8,10,10,9,9,9,9,7,7,9,9,8,8,11,11,11,11,12,12,12,12,12,7,7,7,7,9,9,9,9,9,9],\"target\":[7,8,9,7,8,10,9,7,8,10,9,7,9,8,11,9,12,7,7,13,14,15,16,17,18,19,20,21,22,23,24,14,25,26,27,28,29,30,31,24,32,21,20,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],\"value\":[14,8,2,2,8,2,6,2,4,4,8,4,4,4,8,2,10,8,12,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],\"group\":[\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Aminoglycosides\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Other\",\"Tetracyclines\",\"Other\",\"Other\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\"]},\"nodes\":{\"name\":[\"Aminoglycosides\",\"Fluoroquinolones\",\"Tetracyclines\",\"Phenicols\",\"Sulfonamides & Trimethoprim\",\"Nitrofurans\",\"Macrolides\",\"Enzymatic inactivation\",\"Target alteration\",\"Efflux pump\",\"Target protection\",\"Target replacement\",\"Reduced prodrug activation\",\"aac(3′)\",\"aac(6′)\",\"aadA\",\"aadB\",\"aadD\",\"aph(3′)\",\"aphA15\",\"rrnB*\",\"rrsB*\",\"rrsH*\",\"rsmG*\",\"mdfA\",\"gyrA*\",\"gyrB*\",\"parC*\",\"parE*\",\"qnr\",\"qep\",\"oqxAB\",\"tetX\",\"tetM\",\"tetW\",\"tetA\",\"tetB\",\"tetC\",\"tetD\",\"catB\",\"catII\",\"cmlA\",\"floR\",\"folP*\",\"dfr\",\"sul1\",\"sul2\",\"sul3\",\"sul4\",\"nfsA*\",\"nfsB*\",\"ahpF*\",\"ribB*\",\"ribE*\",\"ermA\",\"ermB\",\"ermC\",\"ereA\",\"mphA\",\"mphB\",\"mefA\",\"mefB\",\"msrA\",\"msrD\"],\"group\":[\"Aminoglycosides\",\"Fluoroquinolones\",\"Tetracyclines\",\"Phenicols\",\"Sulfonamides\",\"Nitrofurans\",\"Macrolides\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Aminoglycosides\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\"]},\"options\":{\"NodeID\":\"name\",\"NodeGroup\":\"group\",\"LinkGroup\":\"group\",\"colourScale\":\"d3.scaleOrdinal()\\n  .domain([\\\"Aminoglycosides\\\", \\\"Fluoroquinolones\\\", \\\"Tetracyclines\\\", \\n           \\\"Phenicols\\\", \\\"Sulfonamides\\\", \\\"Nitrofurans\\\", \\\"Macrolides\\\", \\\"Other\\\"])\\n  .range([\\\"#90CAF9\\\", \\\"#A5D6A7\\\", \\\"#D1C4E9\\\", \\\"#ffffb3\\\", \\\"#fb8072\\\", \\\"#fdb462\\\", \\\"#F8BBD0FF\\\", \\\"#E0E0E0\\\"]);\",\"fontSize\":7,\"fontFamily\":null,\"nodeWidth\":60,\"nodePadding\":10,\"units\":\"\",\"margin\":{\"top\":null,\"right\":null,\"bottom\":null,\"left\":null},\"iterations\":32,\"sinksRight\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nThere are a few things I don't like. The font size and type, the width of the nodes and having the resistance genes on top of the links.\n\nHere I've adjusted these four things within the sankeyNetwork() function using the arguments fontSize, fontFamily, nodeWidth and sinksRight.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Sankey plot\np <- sankeyNetwork(\n  Links = links, Nodes = nodes,\n  Source = \"IDsource\", Target = \"IDtarget\",\n  Value = \"value\", NodeID = \"name\",\n  NodeGroup = \"group\", LinkGroup = \"group\",\n  colourScale = my_color,\n  fontSize = 12, fontFamily = \"Verdana\", nodeWidth = 60, sinksRight = FALSE, width = 900, height = 900\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLinks is a tbl_df. Converting to a plain data frame.\n```\n\n\n:::\n\n```{.r .cell-code}\np\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-1c0256f7ca3bf81656c2\" style=\"width:100%;height:650px;\" class=\"sankeyNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1c0256f7ca3bf81656c2\">{\"x\":{\"links\":{\"source\":[0,0,0,1,1,1,1,2,2,2,2,3,3,4,4,4,5,6,6,7,7,7,7,7,7,7,8,8,8,8,9,7,8,8,8,8,10,9,9,9,7,8,8,10,10,9,9,9,9,7,7,9,9,8,8,11,11,11,11,12,12,12,12,12,7,7,7,7,9,9,9,9,9,9],\"target\":[7,8,9,7,8,10,9,7,8,10,9,7,9,8,11,9,12,7,7,13,14,15,16,17,18,19,20,21,22,23,24,14,25,26,27,28,29,30,31,24,32,21,20,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],\"value\":[14,8,2,2,8,2,6,2,4,4,8,4,4,4,8,2,10,8,12,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],\"group\":[\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Aminoglycosides\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Other\",\"Tetracyclines\",\"Other\",\"Other\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\"]},\"nodes\":{\"name\":[\"Aminoglycosides\",\"Fluoroquinolones\",\"Tetracyclines\",\"Phenicols\",\"Sulfonamides & Trimethoprim\",\"Nitrofurans\",\"Macrolides\",\"Enzymatic inactivation\",\"Target alteration\",\"Efflux pump\",\"Target protection\",\"Target replacement\",\"Reduced prodrug activation\",\"aac(3′)\",\"aac(6′)\",\"aadA\",\"aadB\",\"aadD\",\"aph(3′)\",\"aphA15\",\"rrnB*\",\"rrsB*\",\"rrsH*\",\"rsmG*\",\"mdfA\",\"gyrA*\",\"gyrB*\",\"parC*\",\"parE*\",\"qnr\",\"qep\",\"oqxAB\",\"tetX\",\"tetM\",\"tetW\",\"tetA\",\"tetB\",\"tetC\",\"tetD\",\"catB\",\"catII\",\"cmlA\",\"floR\",\"folP*\",\"dfr\",\"sul1\",\"sul2\",\"sul3\",\"sul4\",\"nfsA*\",\"nfsB*\",\"ahpF*\",\"ribB*\",\"ribE*\",\"ermA\",\"ermB\",\"ermC\",\"ereA\",\"mphA\",\"mphB\",\"mefA\",\"mefB\",\"msrA\",\"msrD\"],\"group\":[\"Aminoglycosides\",\"Fluoroquinolones\",\"Tetracyclines\",\"Phenicols\",\"Sulfonamides\",\"Nitrofurans\",\"Macrolides\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Aminoglycosides\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\"]},\"options\":{\"NodeID\":\"name\",\"NodeGroup\":\"group\",\"LinkGroup\":\"group\",\"colourScale\":\"d3.scaleOrdinal()\\n  .domain([\\\"Aminoglycosides\\\", \\\"Fluoroquinolones\\\", \\\"Tetracyclines\\\", \\n           \\\"Phenicols\\\", \\\"Sulfonamides\\\", \\\"Nitrofurans\\\", \\\"Macrolides\\\", \\\"Other\\\"])\\n  .range([\\\"#90CAF9\\\", \\\"#A5D6A7\\\", \\\"#D1C4E9\\\", \\\"#ffffb3\\\", \\\"#fb8072\\\", \\\"#fdb462\\\", \\\"#F8BBD0FF\\\", \\\"#E0E0E0\\\"]);\",\"fontSize\":12,\"fontFamily\":\"Verdana\",\"nodeWidth\":60,\"nodePadding\":10,\"units\":\"\",\"margin\":{\"top\":null,\"right\":null,\"bottom\":null,\"left\":null},\"iterations\":32,\"sinksRight\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nIt's still not quite what I'd like. To my knowledge that is pretty much all that can be adjusted within the SankeyNetwork() function. However, because the Sankey Network is an htmlwidget (you can check this using the class function) you can use the htmlwidge package to append labels.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(p)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"sankeyNetwork\" \"htmlwidget\"   \n```\n\n\n:::\n:::\n\n\n\n### Using htmlwidgets to adjust the Sankey diagram\n\nThe code below was adapted from the tutorial https://www.geeksforgeeks.org/r-language/how-to-add-axis-labels-using-networkd3-in-r/ and the response on this stack overflow post https://stackoverflow.com/questions/50132459/how-to-add-title-to-a-networkd3-visualisation-when-saving-as-a-web-page\n\nHere I've added a title to my figure and a footnote.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#prepend title\np1 <- htmlwidgets::prependContent(p, htmltools::tags$h1(htmltools::HTML(\"Resistance genes in <em>Escherichia coli</em>\"),\n  style = \"text-align:center; color:#1b2422; font-size:18px; font-family:Verdana;\"))\np1\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<h1 style=\"text-align:center; color:#1b2422; font-size:18px; font-family:Verdana;\">Resistance genes in <em>Escherichia coli</em></h1>\n<div id=\"htmlwidget-f77b783f23039690868a\" style=\"width:100%;height:650px;\" class=\"sankeyNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f77b783f23039690868a\">{\"x\":{\"links\":{\"source\":[0,0,0,1,1,1,1,2,2,2,2,3,3,4,4,4,5,6,6,7,7,7,7,7,7,7,8,8,8,8,9,7,8,8,8,8,10,9,9,9,7,8,8,10,10,9,9,9,9,7,7,9,9,8,8,11,11,11,11,12,12,12,12,12,7,7,7,7,9,9,9,9,9,9],\"target\":[7,8,9,7,8,10,9,7,8,10,9,7,9,8,11,9,12,7,7,13,14,15,16,17,18,19,20,21,22,23,24,14,25,26,27,28,29,30,31,24,32,21,20,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],\"value\":[14,8,2,2,8,2,6,2,4,4,8,4,4,4,8,2,10,8,12,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],\"group\":[\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Aminoglycosides\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Other\",\"Tetracyclines\",\"Other\",\"Other\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\"]},\"nodes\":{\"name\":[\"Aminoglycosides\",\"Fluoroquinolones\",\"Tetracyclines\",\"Phenicols\",\"Sulfonamides & Trimethoprim\",\"Nitrofurans\",\"Macrolides\",\"Enzymatic inactivation\",\"Target alteration\",\"Efflux pump\",\"Target protection\",\"Target replacement\",\"Reduced prodrug activation\",\"aac(3′)\",\"aac(6′)\",\"aadA\",\"aadB\",\"aadD\",\"aph(3′)\",\"aphA15\",\"rrnB*\",\"rrsB*\",\"rrsH*\",\"rsmG*\",\"mdfA\",\"gyrA*\",\"gyrB*\",\"parC*\",\"parE*\",\"qnr\",\"qep\",\"oqxAB\",\"tetX\",\"tetM\",\"tetW\",\"tetA\",\"tetB\",\"tetC\",\"tetD\",\"catB\",\"catII\",\"cmlA\",\"floR\",\"folP*\",\"dfr\",\"sul1\",\"sul2\",\"sul3\",\"sul4\",\"nfsA*\",\"nfsB*\",\"ahpF*\",\"ribB*\",\"ribE*\",\"ermA\",\"ermB\",\"ermC\",\"ereA\",\"mphA\",\"mphB\",\"mefA\",\"mefB\",\"msrA\",\"msrD\"],\"group\":[\"Aminoglycosides\",\"Fluoroquinolones\",\"Tetracyclines\",\"Phenicols\",\"Sulfonamides\",\"Nitrofurans\",\"Macrolides\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Aminoglycosides\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\"]},\"options\":{\"NodeID\":\"name\",\"NodeGroup\":\"group\",\"LinkGroup\":\"group\",\"colourScale\":\"d3.scaleOrdinal()\\n  .domain([\\\"Aminoglycosides\\\", \\\"Fluoroquinolones\\\", \\\"Tetracyclines\\\", \\n           \\\"Phenicols\\\", \\\"Sulfonamides\\\", \\\"Nitrofurans\\\", \\\"Macrolides\\\", \\\"Other\\\"])\\n  .range([\\\"#90CAF9\\\", \\\"#A5D6A7\\\", \\\"#D1C4E9\\\", \\\"#ffffb3\\\", \\\"#fb8072\\\", \\\"#fdb462\\\", \\\"#F8BBD0FF\\\", \\\"#E0E0E0\\\"]);\",\"fontSize\":12,\"fontFamily\":\"Verdana\",\"nodeWidth\":60,\"nodePadding\":10,\"units\":\"\",\"margin\":{\"top\":null,\"right\":null,\"bottom\":null,\"left\":null},\"iterations\":32,\"sinksRight\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n```{.r .cell-code}\n#append footnote\np2 <- htmlwidgets::appendContent(p1, htmltools::tags$p(\"* Genes with point mutations\", style = \"text-align:center; color:#666; font-size:12px; font-family:Verdana;\"))\np2\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<h1 style=\"text-align:center; color:#1b2422; font-size:18px; font-family:Verdana;\">Resistance genes in <em>Escherichia coli</em></h1>\n<div id=\"htmlwidget-82374ba9156384f4f5ad\" style=\"width:100%;height:650px;\" class=\"sankeyNetwork html-widget\"></div>\n<p style=\"text-align:center; color:#666; font-size:12px; font-family:Verdana;\">* Genes with point mutations</p>\n<script type=\"application/json\" data-for=\"htmlwidget-82374ba9156384f4f5ad\">{\"x\":{\"links\":{\"source\":[0,0,0,1,1,1,1,2,2,2,2,3,3,4,4,4,5,6,6,7,7,7,7,7,7,7,8,8,8,8,9,7,8,8,8,8,10,9,9,9,7,8,8,10,10,9,9,9,9,7,7,9,9,8,8,11,11,11,11,12,12,12,12,12,7,7,7,7,9,9,9,9,9,9],\"target\":[7,8,9,7,8,10,9,7,8,10,9,7,9,8,11,9,12,7,7,13,14,15,16,17,18,19,20,21,22,23,24,14,25,26,27,28,29,30,31,24,32,21,20,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],\"value\":[14,8,2,2,8,2,6,2,4,4,8,4,4,4,8,2,10,8,12,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],\"group\":[\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Aminoglycosides\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Other\",\"Tetracyclines\",\"Other\",\"Other\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\"]},\"nodes\":{\"name\":[\"Aminoglycosides\",\"Fluoroquinolones\",\"Tetracyclines\",\"Phenicols\",\"Sulfonamides & Trimethoprim\",\"Nitrofurans\",\"Macrolides\",\"Enzymatic inactivation\",\"Target alteration\",\"Efflux pump\",\"Target protection\",\"Target replacement\",\"Reduced prodrug activation\",\"aac(3′)\",\"aac(6′)\",\"aadA\",\"aadB\",\"aadD\",\"aph(3′)\",\"aphA15\",\"rrnB*\",\"rrsB*\",\"rrsH*\",\"rsmG*\",\"mdfA\",\"gyrA*\",\"gyrB*\",\"parC*\",\"parE*\",\"qnr\",\"qep\",\"oqxAB\",\"tetX\",\"tetM\",\"tetW\",\"tetA\",\"tetB\",\"tetC\",\"tetD\",\"catB\",\"catII\",\"cmlA\",\"floR\",\"folP*\",\"dfr\",\"sul1\",\"sul2\",\"sul3\",\"sul4\",\"nfsA*\",\"nfsB*\",\"ahpF*\",\"ribB*\",\"ribE*\",\"ermA\",\"ermB\",\"ermC\",\"ereA\",\"mphA\",\"mphB\",\"mefA\",\"mefB\",\"msrA\",\"msrD\"],\"group\":[\"Aminoglycosides\",\"Fluoroquinolones\",\"Tetracyclines\",\"Phenicols\",\"Sulfonamides\",\"Nitrofurans\",\"Macrolides\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Aminoglycosides\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\"]},\"options\":{\"NodeID\":\"name\",\"NodeGroup\":\"group\",\"LinkGroup\":\"group\",\"colourScale\":\"d3.scaleOrdinal()\\n  .domain([\\\"Aminoglycosides\\\", \\\"Fluoroquinolones\\\", \\\"Tetracyclines\\\", \\n           \\\"Phenicols\\\", \\\"Sulfonamides\\\", \\\"Nitrofurans\\\", \\\"Macrolides\\\", \\\"Other\\\"])\\n  .range([\\\"#90CAF9\\\", \\\"#A5D6A7\\\", \\\"#D1C4E9\\\", \\\"#ffffb3\\\", \\\"#fb8072\\\", \\\"#fdb462\\\", \\\"#F8BBD0FF\\\", \\\"#E0E0E0\\\"]);\",\"fontSize\":12,\"fontFamily\":\"Verdana\",\"nodeWidth\":60,\"nodePadding\":10,\"units\":\"\",\"margin\":{\"top\":null,\"right\":null,\"bottom\":null,\"left\":null},\"iterations\":32,\"sinksRight\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nI also wanted to change the font style to bold for antibiotic classes and italics for the resistance genes. I got a bit of help from chatgpt for this piece of code.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#The following function was generated using chapgpt\np3 <- htmlwidgets::onRender(p2, '\n  function(el, x) {\n    const boldNames = [\n      \"Aminoglycosides\", \"Fluoroquinolones\", \"Tetracyclines\",\n      \"Phenicols\", \"Sulfonamides & Trimethoprim\", \"Nitrofurans\",\n      \"Enzymatic inactivation\", \"Target alteration\",\n      \"Target protection\", \"Efflux pump\", \"Target replacement\",\n      \"Reduced prodrug activation\", \"Macrolides\"\n    ];\n\n    const italicSubstrings = [\n      \"aac\", \"aad\", \"aph\", \"rr\", \"rsm\", \"qep\", \"qnr\", \"tet\", \"cat\",\n      \"gyr\", \"par\", \"mdf\", \"fol\", \"dfr\", \"nfs\", \"cml\", \"flo\", \"oqx\", \"sul\",\n      \"erm\", \"ereA\", \"mph\", \"mef\", \"msr\", \"ahpF\", \"rib\"\n    ];\n\n    d3.select(el)\n      .selectAll(\".node text\")\n      .style(\"font-weight\", d => boldNames.includes(d.name) ? \"bold\" : \"normal\")\n      .style(\"font-style\", d =>\n        italicSubstrings.some(sub => d.name.includes(sub)) ? \"italic\" : \"normal\"\n      );\n  }\n')\n\np3\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<h1 style=\"text-align:center; color:#1b2422; font-size:18px; font-family:Verdana;\">Resistance genes in <em>Escherichia coli</em></h1>\n<div id=\"htmlwidget-0bbfda076deee9ea957e\" style=\"width:100%;height:650px;\" class=\"sankeyNetwork html-widget\"></div>\n<p style=\"text-align:center; color:#666; font-size:12px; font-family:Verdana;\">* Genes with point mutations</p>\n<script type=\"application/json\" data-for=\"htmlwidget-0bbfda076deee9ea957e\">{\"x\":{\"links\":{\"source\":[0,0,0,1,1,1,1,2,2,2,2,3,3,4,4,4,5,6,6,7,7,7,7,7,7,7,8,8,8,8,9,7,8,8,8,8,10,9,9,9,7,8,8,10,10,9,9,9,9,7,7,9,9,8,8,11,11,11,11,12,12,12,12,12,7,7,7,7,9,9,9,9,9,9],\"target\":[7,8,9,7,8,10,9,7,8,10,9,7,9,8,11,9,12,7,7,13,14,15,16,17,18,19,20,21,22,23,24,14,25,26,27,28,29,30,31,24,32,21,20,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],\"value\":[14,8,2,2,8,2,6,2,4,4,8,4,4,4,8,2,10,8,12,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],\"group\":[\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Aminoglycosides\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Other\",\"Tetracyclines\",\"Other\",\"Other\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\"]},\"nodes\":{\"name\":[\"Aminoglycosides\",\"Fluoroquinolones\",\"Tetracyclines\",\"Phenicols\",\"Sulfonamides & Trimethoprim\",\"Nitrofurans\",\"Macrolides\",\"Enzymatic inactivation\",\"Target alteration\",\"Efflux pump\",\"Target protection\",\"Target replacement\",\"Reduced prodrug activation\",\"aac(3′)\",\"aac(6′)\",\"aadA\",\"aadB\",\"aadD\",\"aph(3′)\",\"aphA15\",\"rrnB*\",\"rrsB*\",\"rrsH*\",\"rsmG*\",\"mdfA\",\"gyrA*\",\"gyrB*\",\"parC*\",\"parE*\",\"qnr\",\"qep\",\"oqxAB\",\"tetX\",\"tetM\",\"tetW\",\"tetA\",\"tetB\",\"tetC\",\"tetD\",\"catB\",\"catII\",\"cmlA\",\"floR\",\"folP*\",\"dfr\",\"sul1\",\"sul2\",\"sul3\",\"sul4\",\"nfsA*\",\"nfsB*\",\"ahpF*\",\"ribB*\",\"ribE*\",\"ermA\",\"ermB\",\"ermC\",\"ereA\",\"mphA\",\"mphB\",\"mefA\",\"mefB\",\"msrA\",\"msrD\"],\"group\":[\"Aminoglycosides\",\"Fluoroquinolones\",\"Tetracyclines\",\"Phenicols\",\"Sulfonamides\",\"Nitrofurans\",\"Macrolides\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Aminoglycosides\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Other\",\"Aminoglycosides\",\"Aminoglycosides\",\"Other\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Fluoroquinolones\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Tetracyclines\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Phenicols\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Sulfonamides\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Nitrofurans\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\",\"Macrolides\"]},\"options\":{\"NodeID\":\"name\",\"NodeGroup\":\"group\",\"LinkGroup\":\"group\",\"colourScale\":\"d3.scaleOrdinal()\\n  .domain([\\\"Aminoglycosides\\\", \\\"Fluoroquinolones\\\", \\\"Tetracyclines\\\", \\n           \\\"Phenicols\\\", \\\"Sulfonamides\\\", \\\"Nitrofurans\\\", \\\"Macrolides\\\", \\\"Other\\\"])\\n  .range([\\\"#90CAF9\\\", \\\"#A5D6A7\\\", \\\"#D1C4E9\\\", \\\"#ffffb3\\\", \\\"#fb8072\\\", \\\"#fdb462\\\", \\\"#F8BBD0FF\\\", \\\"#E0E0E0\\\"]);\",\"fontSize\":12,\"fontFamily\":\"Verdana\",\"nodeWidth\":60,\"nodePadding\":10,\"units\":\"\",\"margin\":{\"top\":null,\"right\":null,\"bottom\":null,\"left\":null},\"iterations\":32,\"sinksRight\":false}},\"evals\":[],\"jsHooks\":{\"render\":[{\"code\":\"\\n  function(el, x) {\\n    const boldNames = [\\n      \\\"Aminoglycosides\\\", \\\"Fluoroquinolones\\\", \\\"Tetracyclines\\\",\\n      \\\"Phenicols\\\", \\\"Sulfonamides & Trimethoprim\\\", \\\"Nitrofurans\\\",\\n      \\\"Enzymatic inactivation\\\", \\\"Target alteration\\\",\\n      \\\"Target protection\\\", \\\"Efflux pump\\\", \\\"Target replacement\\\",\\n      \\\"Reduced prodrug activation\\\", \\\"Macrolides\\\"\\n    ];\\n\\n    const italicSubstrings = [\\n      \\\"aac\\\", \\\"aad\\\", \\\"aph\\\", \\\"rr\\\", \\\"rsm\\\", \\\"qep\\\", \\\"qnr\\\", \\\"tet\\\", \\\"cat\\\",\\n      \\\"gyr\\\", \\\"par\\\", \\\"mdf\\\", \\\"fol\\\", \\\"dfr\\\", \\\"nfs\\\", \\\"cml\\\", \\\"flo\\\", \\\"oqx\\\", \\\"sul\\\",\\n      \\\"erm\\\", \\\"ereA\\\", \\\"mph\\\", \\\"mef\\\", \\\"msr\\\", \\\"ahpF\\\", \\\"rib\\\"\\n    ];\\n\\n    d3.select(el)\\n      .selectAll(\\\".node text\\\")\\n      .style(\\\"font-weight\\\", d => boldNames.includes(d.name) ? \\\"bold\\\" : \\\"normal\\\")\\n      .style(\\\"font-style\\\", d =>\\n        italicSubstrings.some(sub => d.name.includes(sub)) ? \\\"italic\\\" : \\\"normal\\\"\\n      );\\n  }\\n\",\"data\":null}]}}</script>\n```\n\n:::\n:::\n\n\n\n## Saving the Sankey diagram\n\nIf you are trying this code or similar and want to save your plot as a png you will not be able to use ggsave Because the Sankey Network is an htmlwidget. First save your plot as an html and then take a screenshot using webshot.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhtmlwidgets::saveWidget(p3, \"output/sankey.html\", selfcontained = TRUE)\nwebshot(\"output/sankey.html\", file = \"output/sankey_arg.png\", vwidth = 900, vheight = 900)\n```\n:::\n\n\n\nOne thing I haven't been able to work out is how remove the white space on either side and align the footer to the gene name column, when I save the plot as a png. If anyone reading this has any tips please email me or DM on LinkedIn.\n\nLastly here are some references I used for generating the resistance gene list:\n",
    "supporting": [
      "sankey_amr_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"sankey_amr_files/libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"sankey_amr_files/libs/d3-4.9.1/d3.min.js\"></script>\n<script src=\"sankey_amr_files/libs/sankey-1/sankey.js\"></script>\n<script src=\"sankey_amr_files/libs/sankeyNetwork-binding-0.4.1/sankeyNetwork.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}